<template name="car">
    <block wx:for="{{ carSelectList }}" wx:key="" wx:if="{{ hasList }}">
        <block wx:if="{{ item.type !== 'used' && item.planList.length > 0 }}">
            <view class="title">{{ item.type_name }}</view>
            <block wx:for="{{ item.planList }}" wx:for-item="card" wx:for-index="cIndex" wx:key="">
                <wux-media wux-class="{{ cIndex === 0 ? 'media' : 'media--line' }}" thumbStyle="width: 180rpx; background: #f1efef" thumb="{{ config.upload.cdnurl + card.models_main_images }}" data-id="{{ card.id }}" data-type="{{ card.type }}" bindtap="onOpenDetail">
                    <view class="media__title wux-ellipsis--l2">{{ card.models.name }}</view>
                    <view class="wux-clearfix">
                        <view class="media__desc media__desc--payment wux-pull-left wux-mr--10">首付 {{ card.payment / 10000 }} 万</view>
                        <view class="media__desc media__desc--monthly wux-pull-left wux-mr--10">月供 {{ card.monthly }} 元</view>
                        <view class="media__desc wux-pull-right">
                            <view class="fa fa-map-marker"></view> {{ card.city.cities_name }}</view>
                        <view class="media__desc wux-pull-right wux-mr--10" wx:if="{{ card.popularity }}">
                            <view class="fa fa-map-marker"></view> {{ card.popularity || 0 }} W</view>
                    </view>
                </wux-media>
            </block>
        </block>
        <block wx:if="{{ item.type === 'used' && item.planList.length > 0 }}">
            <view class="title">{{ item.type_name }}</view>
            <block wx:for="{{ item.planList }}" wx:for-item="card" wx:for-index="cIndex" wx:key="">
                <wux-media wux-class="{{ cIndex === 0 ? 'media' : 'media--line' }}" thumbStyle="width: 270rpx; height: 180rpx; background: #f1efef" thumb="{{ config.upload.cdnurl + card.models_main_images }}" data-id="{{ card.id }}" data-type="{{ card.type }}" bindtap="onOpenDetail">
                    <view class="media__title wux-ellipsis--l2">{{ card.models.name }}</view>
                    <view class="media__desc media__desc--price wux-mt--5 wux-ellipsis--l2">{{ card.car_licensedate + '/' + card.kilometres / 10000 + 'W公里' }}</view>
                    <view class="wux-clearfix">
                        <view class="media__desc media__desc--monthly wux-pull-left wux-mr--10" wx:if="{{ card.models.price }}">{{ card.models.price / 10000 }} 万</view>
                        <view class="media__desc media__desc--payment wux-pull-left wux-mr--10">首付 {{ card.newpayment / 10000 }} 万</view>
                        <view class="media__desc wux-pull-right">
                            <view class="fa fa-map-marker"></view> {{ card.city.cities_name }}
                        </view>
                    </view>
                </wux-media>
            </block>
        </block>
    </block>
    <view class="notfound" wx:if="{{ !hasList }}">
        <view class="notfound__title">您还没有收藏宝贝哦~</view>
        <view class="notfound__button" bindtap="toMore">去逛逛</view>
    </view>
</template>

<view class="container">
    <view class="header">
        <view class="userinfo">
            <wux-avatar wux-class="avatar" src="{{ userInfo.avatar }}" />
            <view class="wux-mt--10">{{ userInfo.nickname }}</view>
        </view>
        <view class="other">
            <view class="sign" bindtap="signIn">立即签到</view>
            <view class="wux-mt--20">
                <text class="score">积分：{{ score }}</text>
                <text class="line"></text>
                <text class="coupon">优惠券：{{ couponCount }}</text>
            </view>
        </view>
    </view>
    <wux-tabs wux-class="wux-mt--10" theme="positive" current="{{ style }}" controlled bind:change="onChange">
        <wux-tab key="collection" title="我的收藏"></wux-tab>
        <wux-tab key="subscribe" title="我的预约"></wux-tab>
        <wux-tab key="pickup" title="已提车"></wux-tab>
    </wux-tabs>
    <view class="body">
        <template is="car" data="{{ ...collection, ...globalData }}" wx:if="{{ style === 'collection' }}" />
        <template is="car" data="{{ ...subscribe, ...globalData }}" wx:if="{{ style === 'subscribe' }}" />
        <template is="car" data="{{ ...pickup, ...globalData }}" wx:if="{{ style === 'pickup' }}" />
    </view>
    <wux-grids wux-class="wux-mt--10" bordered="{{ false }}" col="3">
        <wux-grid thumb="/assets/images/score.png">
            <view class="grid__name">我的积分</view>
        </wux-grid>
        <wux-grid thumb="/assets/images/message.png">
            <view class="grid__name">我的消息</view>
        </wux-grid>
        <wux-grid thumb="/assets/images/service.png">
            <view class="grid__name">我的客户</view>
        </wux-grid>
    </wux-grids>
    <view class="wish">
        <view class="wish__hd">
            <image class="wish__image" src="/assets/images/upload.png"></image>
        </view>
        <view class="wish__bd">关于友车有家</view>
        <view class="wish__ft"></view>
    </view>
    <view class="footer">©成都君忆汽车服务有限公司 • All Rights Reserved </view>
</view>